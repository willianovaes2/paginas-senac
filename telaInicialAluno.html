<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/css/index.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sanchez:ital@0;1&display=swap');
    </style>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
    <script src="../../assets/js/login1.js" defer></script>
    <title>Admin Cursos - Senac</title>
</head>

<body class="d-flex flex-column min-vh-100">
    <header>
        <div class="header-top">

        </div>

        <div class="header-mid shadow">
            <a class="logo-senac">
                <img src="assets/images/logo-senac.png" alt="Logo do Senac" width="350px">
            </a>
        </div>
    </header>

    <main class="container-xl py-4 shadow">

        <!-- Conteudo Principal -->

        <section class="container-fluid">

            <!-- HEADER -->
            <div class="card shadow-sm rounded-4 p-4 mb-4">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <h4 class="fw-bold text-primary mb-1">Controle de Presen√ßa</h4>
                        <small class="text-muted">Visualiza√ß√£o do Aluno</small>
                    </div>
                </div>

                <hr>

                <div class="d-flex align-items-center gap-3">
                    <span class="badge rounded-pill bg-primary-subtle text-primary fs-6">üë§</span>
                    <div>
                        <div class="fw-semibold">{{aluno->nome}}</div>
                        <small class="text-muted">{{aluno->ra}}</small>
                    </div>
                </div>
            </div>

            <!-- UC -->
            <div class="card shadow-sm rounded-4 p-4 mb-4">
                <div class="d-flex justify-content-between align-items-center">
                    <div class="d-flex align-items-center gap-3">
                        <i class="bi bi-book fs-5"></i>
                        <div>
                            <div class="fw-bold">{{uc->nome}}</div>
                            <small class="text-muted">{{uc->docente}}</small>
                        </div>
                    </div>

                    <div class="dropdown">
                        <button class="btn btn-warning text-white dropdown-toggle" type="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            Ver outras UCs
                        </button>

                        <ul class="dropdown-menu dropdown-menu-end">
                            @foreach($ucs as $uc)
                            <li>
                                <a href="#" class="dropdown-item uc-item" data-uc-id="{{ $uc->id }}">
                                    {{ $uc->nome }}
                                </a>
                            </li>
                            @endforeach
                        </ul>

                        <!-- public function controlePresenca($aluno_id, $uc_id = null)
                        {
                        $aluno = Aluno::findOrFail($aluno_id);

                        // Todas as UCs do aluno
                        $ucs = $aluno->ucs;

                        // Se n√£o escolher UC, pega a primeira
                        if (!$uc_id) {
                        $ucSelecionada = $ucs->first();
                        } else {
                        $ucSelecionada = $ucs->where('id', $uc_id)->first();
                        }

                        // Exemplo de c√°lculo
                        $totalAulas = $ucSelecionada->aulas->count();
                        $presencas = $ucSelecionada->presencas()
                        ->where('aluno_id', $aluno->id)
                        ->where('presente', 1)
                        ->count();

                        $faltas = $totalAulas - $presencas;
                        $percentual = $totalAulas > 0
                        ? ($presencas / $totalAulas) * 100
                        : 0;

                        return view('controle-presenca', compact(
                        'aluno',
                        'ucs',
                        'ucSelecionada',
                        'totalAulas',
                        'presencas',
                        'faltas',
                        'percentual'
                        ));
                        }
                        üß± 2Ô∏è‚É£ Rota
                        Route::get('/presenca/{aluno}/{uc?}',
                        [PresencaController::class, 'controlePresenca']
                        )->name('presenca'); -->

                        <!-- Testar algum destes -->

                        <!-- PASSO 2 ‚Äî Criar rota
                        Route::get('/presenca/dados/{uc}/{aluno}', [PresencaController::class, 'buscarDados']);

                        ‚úÖ PASSO 3 ‚Äî Controller
                        public function buscarDados($ucId, $alunoId)
                        {
                        $dados = Presenca::where('uc_id', $ucId)
                        ->where('aluno_id', $alunoId)
                        ->first();

                        return response()->json([
                        'percentual' => $dados->percentual,
                        'total_aulas' => $dados->total_aulas,
                        'presencas' => $dados->presencas,
                        'faltas' => $dados->faltas
                        ]);
                        } -->
                    </div>
                </div>
            </div>

            <!-- STATUS -->
            <div class="alert alert-success rounded-4 d-flex align-items-center gap-3 mb-4">
                <span class="badge bg-success rounded-pill fs-4">‚úî</span>
                <div>
                    <div class="fw-bold fs-4">80.0%</div>
                    <small>Voc√™ est√° aprovado!</small>
                </div>
            </div>

            <!-- RESUMO -->
            <div class="row g-3 mb-4">

                <div class="col-md-4">
                    <div class="p-3 bg-primary-subtle rounded-4">
                        <small>Total de Aulas</small>
                        <h3 class="fw-bold text-primary mb-0">20</h3>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="p-3 bg-success-subtle rounded-4">
                        <small>Presen√ßas</small>
                        <h3 class="fw-bold text-success mb-0">16</h3>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="p-3 bg-danger-subtle rounded-4">
                        <small>Faltas</small>
                        <h3 class="fw-bold text-danger mb-0">4</h3>
                    </div>
                </div>

            </div>
        </section>

    </main>

    <footer class="mt-auto">
        <div class="footer-top">
            <p>Senac - Servi√ßo Nacional de Aprendizagem Comercial - CNPJ: <a href="#">[consulte as unidades]</a> ou pelo
                <a href="#">Fale Conosco</a> Informa√ß√µes: 4090-1030 para capitais e regi√µes metropolitanas e
                0800-883-2000 para demais regi√µes
            </p>
        </div>

        <div class="footer-bottom">
            <picture class="logo-branco">
                <img src="assets/images/logo_branco.png" alt="Logotipo do Senac" width="120">
            </picture>

            <div class="logos">
                <a href="#" class="me-4 text-reset">
                    <i class="bi bi-facebook"></i>
                </a>
                <a href="#" class="me-4 text-reset">
                    <i class="bi bi-twitter-x"></i>
                </a>
                <a href="#" class="me-4 text-reset">
                    <i class="bi bi-linkedin"></i>
                </a>
                <a href="#" class="me-4 text-reset">
                    <i class="bi bi-youtube"></i>
                </a>
            </div>
        </div>
    </footer>

</body>

</html>